# This is the main configuration file for the application.
# ~~~~~
#
# More settings are in common/src/main/resources/reference.conf
#
# Do not edit this file. Instead, set environment variables.

# Secret key
# ~~~~~
# The secret key is used to secure cryptographics functions.
# If you deploy your application to several instances be sure to use the same key!
play.crypto.secret="]EZEnf=<QPIbFEm^C@xG;o4XAI?u^T2IKAo:nJt7=S:_5hY2MuieEr`xQ7i=D_Yt"
play.crypto.secret=${?OV_APPLICATION_SECRET}

# The application languages
# ~~~~~
play.i18n.langs=["en"]

# Email
# ~~~~~
# Configure how emails get sent. If SMTP_HOST is empty, the mailer will be a
# "mock" that outputs to stdout instead of connecting to any server.
play.mailer {
  host=""
  port=0
  ssl=no
  tls=no
  user=""
  password=""
  host=${?SMTP_HOST}
  port=${?SMTP_PORT}
  ssl=${?SMTP_SSL}
  tls=${?SMTP_TLS}
  user=${?SMTP_USERNAME}
  password=${?SMTP_PASSWORD}
}

mail.from="no-reply@overviewdocs.com"
mail.from=${?MAIL_FROM}

# Assets
# ~~~~~
# By default, we don't compress assets.
assets.compress=no

# Analytics
# ~~~~~~~~~
# By default, we do not use Google Analytics
analytics.ga_tracking_id=""
analytics.ga_tracking_id=${?GOOGLE_ANALYTICS_ID}

# By default, we do not use Intercom
#
# To see Intercom on its test account, run this:
#
# INTERCOM_APP_ID=wivdqio5 INTERCOM_SECRET_KEY=[key] ./sbt run
#
# Where [key] is at https://www.intercom.io/apps/wivdqio5/secure_mode_settings
#analytics.intercom.app_id=${?INTERCOM_APP_ID}
#analytics.intercom.secret_key=${?INTERCOM_SECRET_KEY}

# Overview
# ~~~~~~~~
# By default, users need to log in (and register with email accounts)
overview.multi_user=true
overview.multi_user=${?OV_MULTI_USER}
overview.allow_registration=true
overview.allow_registration=${?OV_ALLOW_REGISTRATION}
overview.twitter_consumer_key="bbdaJbFqZex5B11n5lTw"

# If the welcome banner is defined, it replaces the logo and video on the welcome page
#overview.welcome_banner="Welcome to your local Overview server!"
overview.welcome_banner=${?OV_WELCOME_BANNER}

# By default, non-admin users can export
overview.admin_only_export=false 
overview.admin_only_export=${?OV_ADMIN_ONLY_EXPORT}

# URLs for welcome email
overview.help_url = "https://www.overviewdocs.com/help"
overview.user_forum_url = "https://groups.google.com/forum/?fromgroups=#!forum/overview-users"
overview.contact_url = "https://blog.overviewdocs.com/contact"

# Mailchimp configuration
mailchimp.mock=true

# Redis configuration
redis {
  host="localhost"
  port="9020"
  host=${?REDIS_HOST}
  port=${?REDIS_PORT}
}

# Don't require CSRF on JSON requests. That includes API requests and
# integration-test "create user" requests. (It also includes our own
# JavaScript, but that tends to include csrfToken anyway.)
#
# Play docs suggest that buggy browser extensions can bypass CSRF checks that
# ought to occur. There's nothing we can do to defend against buggy browser
# extensions in general, though, so we don't expose much by opening this up.
play.filters.csrf.contentType {
  whiteList = [ "application/json", "application/json; charset=utf-8" ]
}

# For integration tests, we sometimes DELETE a user. Again, there's no known
# CSRF exploit here....
play.filters.csrf.method {
  whiteList = [ "GET", "HEAD", "OPTIONS", "DELETE" ]
}

# Don't require CSRF on _AJAX_ requests. This is a bit more lax, security-wise,
# but again: it's according to spec.
#
# Some of our code AJAX code (particularly Backbone methods) is a bit too
# simple to handle the CSRF token.
play.filters.csrf.header.bypassHeaders {
  X-Requested-With = "*"
}

worker {
  message_broker_hostname: "localhost"
  message_broker_hostname=${?MESSAGE_BROKER_HOSTNAME}
  message_broker_port: 9030
  message_broker_port=${?MESSAGE_BROKER_PORT}

  akka {
    actor {
      provider: "akka.remote.RemoteActorRefProvider"
    }

    remote {
      enabled-transports: [ "akka.remote.netty.tcp" ]
      retry-gate-closed-for: 1s
      netty.tcp {
        hostname: "localhost"
        hostname: ${?MESSAGE_BROKER_CLIENT_HOSTNAME}
        port: 9031 # The message broker is allowed to connect to this. On production.
        port: ${?MESSAGE_BROKER_CLIENT_PORT}
      }
    }
  }
}
